{% extends "base.html" %}
{% block content %}
<div class="container">
  <aside class="sidebar">
    <h3>Your profile</h3>
    {% if current_user.is_authenticated %}
      <p><strong>{{ current_user.name or current_user.email }}</strong></p>
      <p>Crop: {{ current_user.primary_crop or "â€”" }}</p>
      <p>Region: {{ current_user.region or "â€”" }}</p>
      <p>Lang: {{ current_user.preferred_language or "en" }}</p>
      <a class="btn" href="{{ url_for('profile') }}">Edit profile</a>
    {% else %}
      <p><a href="{{ url_for('login') }}">Login</a> to save chat & see profile.</p>
    {% endif %}
    {% if recent_users %}<hr><h4>Recent users (admin)</h4><ul class="user-list">{% for u in recent_users %}<li><a href="{{ url_for('admin_view_user', user_id=u.id) }}">{{ u.email }} - {{ u.name or 'â€”' }}</a></li>{% endfor %}</ul>{% endif %}
  </aside>
  <section class="chat-panel">
    <div id="messages" class="messages" aria-live="polite"></div>
    <form id="chatForm" class="chat-form" onsubmit="return false;">
        <input id="msg" aria-label="Type your question" placeholder="Ask about crops, pests or soil (e.g. 'best soil for cotton')" autocomplete="off">

        <!-- Image Upload Button - properly connected to hidden file input -->
        <label for="imageInput" class="btn" style="cursor: pointer;" title="Upload Image for Analysis">
            ðŸ“· Image
        </label>
        <input type="file" id="imageInput" accept="image/*" style="display: none;">

        <!-- Voice Input Button -->
        <button id="voiceBtn" type="button" class="btn" title="Voice Input">ðŸŽ¤ Voice</button>

        <!-- Send Button -->
        <button id="sendBtn" type="button" class="btn">Send</button>
    </form>
</section>
</div>
{% endblock %}